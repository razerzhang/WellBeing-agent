# 🚀 流式输出功能演示

## 快速开始

### 1. 安装依赖
```bash
pip install -r requirements.txt
```

### 2. 启动演示
```bash
python start_streaming_demo.py
```

### 3. 体验流式输出
1. 在浏览器中打开 `http://localhost:8000`
2. 启用右上角的"流式输出"开关
3. 发送健康相关问题，例如：
   - "我想了解如何改善饮食习惯"
   - "请给我一些运动建议"
   - "如何改善睡眠质量？"

## 流式输出效果

启用流式输出后，你会看到：

```
🌱 开始分析您的健康需求...

📊 分析完成！检测到您需要 diet 方面的建议

根据你的需求，我建议你关注以下几个方面：

🥗 均衡营养搭配
- 蛋白质：瘦肉、鱼类、豆类、蛋类
- 碳水化合物：全谷物、蔬菜、水果
- 健康脂肪：坚果、橄榄油、牛油果
- 维生素和矿物质：深色蔬菜、水果

🍽️ 饮食习惯建议
- 定时定量，规律进餐
- 细嚼慢咽，享受食物
- 多样化选择，营养均衡
- 适量饮水，保持水分

🤔 为了更好地帮助您，请考虑以下问题：
1. 你目前的主要饮食问题是什么？
2. 你有特殊的饮食限制或偏好吗？
3. 你的日常活动水平如何？

✅ diet 建议生成完成！
```

## 功能对比

| 功能 | 流式输出 | 普通模式 |
|------|----------|----------|
| 响应速度 | 实时逐步显示 | 等待完整回复 |
| 用户体验 | 流畅、互动性强 | 传统、静态 |
| 进度可见 | ✅ 显示处理步骤 | ❌ 无进度信息 |
| 可控制性 | ✅ 可暂停/继续 | ❌ 一次性显示 |

## 技术特性

- **Server-Sent Events (SSE)**: 现代浏览器原生支持
- **异步流式处理**: Python异步生成器
- **智能内容分块**: 按句子分割，自然阅读体验
- **自动降级**: 流式不可用时自动切换到普通模式
- **错误处理**: 完善的错误恢复机制

## 自定义配置

### 调整流式速度
在 `wellbeing_agent.py` 中修改延迟时间：
```python
await asyncio.sleep(0.1)  # 0.1秒延迟
```

### 修改API地址
在 `frontend/script.js` 中修改：
```javascript
this.apiBaseUrl = 'http://localhost:8000';
```

## 故障排除

### 流式输出不工作
1. 检查服务器是否运行
2. 确认流式输出开关已启用
3. 查看浏览器控制台错误信息

### 内容显示不完整
1. 等待流式输出完成
2. 检查网络连接
3. 尝试刷新页面

## 下一步

- [ ] 尝试不同的健康问题
- [ ] 测试流式输出的开关功能
- [ ] 观察不同网络条件下的表现
- [ ] 提供反馈和改进建议

享受流畅的流式输出体验！ 🌟
